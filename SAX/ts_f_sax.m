% Copyright and terms of use (DO NOT REMOVE):
% The code is made freely available for non-commercial uses only, provided that the copyright
% header in each file not be removed, and suitable citation(s) (see below) be made for papers
% published based on the code.
%
% The code is not optimized for speed, and we are not responsible for any errors that might
% occur in the code.
%
% The copyright of the code is retained by the authors.  By downloading/using this code you
% agree to all the terms stated above.
%
%   Lin, J., Keogh, E., Lonardi, S. & Chiu, B.
%   "A Symbolic Representation of Time Series, with Implications for Streaming Algorithms."
%   In proceedings of the 8th ACM SIGMOD Workshop on Research Issues in Data Mining and
%   Knowledge Discovery. San Diego, CA. June 13, 2003.
%
%
%   Lin, J., Keogh, E., Patel, P. & Lonardi, S.
%   "Finding Motifs in Time Series". In proceedings of the 2nd Workshop on Temporal Data Mining,
%   at the 8th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining.
%   Edmonton, Alberta, Canada. July 23-26, 2002
%
% This function takes in a time series and convert it to string(s).
% There are two options:
%   1. Convert the entire time series to ONE string
%   2. Use sliding windows, extract the subsequences and convert these subsequences to strings
%
% For the first option, simply enter the length of the time series as "N"
%   ex. We have a time series of length 32 and we want to convert it to a 8-symbol string,
%       with alphabet size 3:
%       timeseries2symbol(data, 32, 8, 3)
% For the second option, enter the desired sliding window length as "N"
%   ex. We have a time series of length 32 and we want extract subsequences of length 32 using
%       sliding windows, and convert the subsequences to 8-symbol strings, with alphabet size 3:
%       timeseries2symbol(data, 16, 8, 3)
%
%
% Input:
%   data              is the raw time series.
%   N                 is the length of sliding window (use the length of the raw time series
%                     instead if you don't want to have sliding windows)
%   n                 is the number of symbols in the low dimensional approximation of the sub sequence.
%   alphabet_size     is the number of discrete symbols. 2 <= alphabet_size <= 10, although alphabet_size = 2 is a special "useless" case.
%   NR_opt            1: no numerosity reduction (record everything)
%                     2: numerosity reduction (record only if the string is different from the last recorded string)
%                        (default)
%                     3: advanced numerosity reduction (record only if the mindist between current string and
%                        last recorded string > 0)
%                     4: more reduction (record only if the subsequence is NOT monotonic)
%
% Output:
%   symbolic_data:    matrix of symbolic data (no-repetition).  If consecutive subsequences
%                     have the same string, then only the first occurrence is recorded, with
%                     a pointer to its location stored in "pointers"
%   pointers:         location of the first occurrences of the strings
%
% N/n must be an integer, otherwise the program will give a warning, and abort.
%
% The variable "win_size" is assigned to N/n, this is the number of data points on the raw
% time series that will be mapped to a single symbol, and can be imagined as the
% "compression rate".
%
% The symbolic data is returned in "symbolic_data", with pointers to the subsequences
%
%
%
%
% Copyright (c) 2003, Eamonn Keogh, Jessica Lin, Stefano Lonardi, Pranav Patel.  All rights reserved.
%
function [symbolic_data, pointers] =  ts_f_sax(data, N, n, alphabet_size, NR_opt)

if nargin < 4
    disp('usage: sax_modified(data, window_len, num_segment, alphabet_size, [numerosity_reduction_option]');
    return;
end

%if (N/n - floor(N/n))                               % N/n must be an integer.
%    disp('N/n must be an integer. Aborting '); , return;
%end;

if alphabet_size > 64
    disp('Currently alphabet_size cannot be larger than 64.  Please update the breakpoint table if you wish to do so');
    return;
end

if nargin < 5
    NR_opt = 2;
end

win_size = floor(N/n);                              % win_size is the number of data points on the raw time series that will be mapped to a single symbol

pointers         = [];                                                  % Initialize pointers,
symbolic_data = zeros(1,n);                                             % Initialize symbolic_data with a void string, it will be removed later.
all_string = zeros(length(data)-N+1,n);


% Scan accross the time series extract sub sequences, and converting them to strings.
for i = 1 : length(data) - (N -1)

    if mod(i, 1000) == 0
        disp(num2str(i));
    end

    % Remove the current subsection.
    sub_section = data(i:i + N -1);

    % Z normalize it.
    sub_section = (sub_section - mean(sub_section))/std(sub_section);

    % take care of the special case where there is no dimensionality reduction
    if N == n
        PAA = sub_section;

    % N is not dividable by n
    else
        if (N/n - floor(N/n))
            temp = zeros(n, N);
            for j = 1 : n
                temp(j, :) = sub_section;
            end
            expanded_sub_section = reshape(temp, 1, N*n);
            PAA = [mean(reshape(expanded_sub_section, N, n))];
        % N is dividable by n
        else
            PAA = [mean(reshape(sub_section,win_size,n))];
        end
    % Convert to PAA.
    %else
   %     PAA = [mean(reshape(sub_section,win_size,n))];
    end

    %--------------------------------------------------------------------------------------------------------------------------------------------------------
    %--------------------------------------------------------------------------------------------------------------------------------------------------------
    %--------------------------------------------------------------------------------------------------------------------------------------------------------
    % Convert the PAA to a string.

    current_string = zeros(1, length(PAA));

    switch alphabet_size
        case 2, cut_points  = [-Inf 0];
        case 3, cut_points  = [-Inf -0.430727299295457 0.430727299295457];
        case 4, cut_points  = [-Inf -0.674489750196082 0 0.674489750196082];
        case 5, cut_points  = [-Inf -0.841621233572914 -0.2533471031358 0.2533471031358 0.841621233572914];
        case 6, cut_points  = [-Inf -0.967421566101701 -0.430727299295457 0 0.430727299295457 0.967421566101701];
        case 7, cut_points  = [-Inf -1.06757052387814 -0.565948821932863 -0.180012369792705 0.180012369792705 0.565948821932863 1.06757052387814];
        case 8, cut_points  = [-Inf -1.15034938037601 -0.674489750196082 -0.318639363964375 0 0.318639363964375 0.674489750196082 1.15034938037601];
        case 9, cut_points  = [-Inf -1.22064034884735 -0.764709673786387 -0.430727299295457 -0.139710298881862 0.139710298881862 0.430727299295457 0.764709673786387 1.22064034884735];
        case 10, cut_points = [-Inf -1.2815515655446 -0.841621233572914 -0.524400512708041 -0.2533471031358 0 0.2533471031358 0.524400512708041 0.841621233572914 1.2815515655446];
        case 11, cut_points = [-Inf -1.33517773611894 -0.908457868537385 -0.604585346583237 -0.348755695517045 -0.114185294321428 0.114185294321428 0.348755695517045 0.604585346583237 0.908457868537385 1.33517773611894];
        case 12, cut_points = [-Inf -1.38299412710064 -0.967421566101701 -0.674489750196082 -0.430727299295457 -0.210428394247925 0 0.210428394247925 0.430727299295457 0.674489750196082 0.967421566101701 1.38299412710064];
        case 13, cut_points = [-Inf -1.42607687227285 -1.0200762327862 -0.73631591737613 -0.502402223373355 -0.293381232121193 -0.0965586152896392 0.0965586152896392 0.293381232121193 0.502402223373355 0.73631591737613 1.0200762327862 1.42607687227285];
        case 14, cut_points = [-Inf -1.46523379268552 -1.06757052387814 -0.791638607743375 -0.565948821932863 -0.36610635680057 -0.180012369792705 0 0.180012369792705 0.36610635680057 0.565948821932863 0.791638607743375 1.06757052387814 1.46523379268552];
        case 15, cut_points = [-Inf -1.50108594604403 -1.11077161663679 -0.841621233572914 -0.622925723210088 -0.430727299295457 -0.2533471031358 -0.0836517339071292 0.0836517339071292 0.2533471031358 0.430727299295457 0.622925723210088 0.841621233572914 1.11077161663679 1.50108594604403];
        case 16, cut_points = [-Inf -1.53412054435255 -1.15034938037601 -0.887146559018876 -0.674489750196082 -0.488776411114669 -0.318639363964375 -0.157310684610171 0 0.157310684610171 0.318639363964375 0.488776411114669 0.674489750196082 0.887146559018876 1.15034938037601 1.53412054435255];
        case 17, cut_points = [-Inf -1.5647264713618 -1.18683143275582 -0.928899491647271 -0.721522283982343 -0.541395085129088 -0.377391943828554 -0.223007830940367 -0.0737912738082727 0.0737912738082727 0.223007830940367 0.377391943828554 0.541395085129088 0.721522283982343 0.928899491647271 1.18683143275582 1.5647264713618];
        case 18, cut_points = [-Inf -1.59321881802305 -1.22064034884735 -0.967421566101701 -0.764709673786387 -0.589455797849778 -0.430727299295457 -0.282216147062508 -0.139710298881862 0 0.139710298881862 0.282216147062508 0.430727299295457 0.589455797849778 0.764709673786387 0.967421566101701 1.22064034884735 1.59321881802305];
        case 19, cut_points = [-Inf -1.61985625863827 -1.25211952026522 -1.00314796766253 -0.8045963803603 -0.633640000779701 -0.47950565333095 -0.336038140371823 -0.199201324789267 -0.0660118123758408 0.0660118123758408 0.199201324789267 0.336038140371823 0.47950565333095 0.633640000779701 0.8045963803603 1.00314796766253 1.25211952026522 1.61985625863827];
        case 20, cut_points = [-Inf -1.64485362695147 -1.2815515655446 -1.03643338949379 -0.841621233572914 -0.674489750196082 -0.524400512708041 -0.385320466407567 -0.2533471031358 -0.125661346855074 0 0.125661346855074 0.2533471031358 0.385320466407567 0.524400512708041 0.674489750196082 0.841621233572914 1.03643338949379 1.2815515655446 1.64485362695147];
        case 21, cut_points = [-Inf -1.66839119394708 -1.30917171678578 -1.06757052387814 -0.876142849246841 -0.712443032389489 -0.565948821932863 -0.430727299295457 -0.302980448056206 -0.180012369792705 -0.059717099785323 0.059717099785323 0.180012369792705 0.302980448056206 0.430727299295457 0.565948821932863 0.712443032389489 0.876142849246841 1.06757052387814 1.30917171678578 1.66839119394708];
        case 22, cut_points = [-Inf -1.6906216295849 -1.33517773611894 -1.09680356209351 -0.908457868537385 -0.747858594763302 -0.604585346583237 -0.472789120992267 -0.348755695517045 -0.229884117579232 -0.114185294321428 0 0.114185294321428 0.229884117579232 0.348755695517045 0.472789120992267 0.604585346583237 0.747858594763302 0.908457868537385 1.09680356209351 1.33517773611894 1.6906216295849];
        case 23, cut_points = [-Inf -1.71167530650973 -1.35973738393861 -1.12433823156864 -0.938814316876903 -0.781033811522709 -0.640666889919105 -0.511936213871329 -0.391196258189472 -0.27592106310796 -0.164210777079331 -0.0545189148481012 0.0545189148481012 0.164210777079331 0.27592106310796 0.391196258189472 0.511936213871329 0.640666889919105 0.781033811522709 0.938814316876903 1.12433823156864 1.35973738393861 1.71167530650973];
        case 24, cut_points = [-Inf -1.73166439612225 -1.38299412710064 -1.15034938037601 -0.967421566101701 -0.812217801499913 -0.674489750196082 -0.548522282698098 -0.430727299295457 -0.318639363964375 -0.210428394247925 -0.104633455614075 0 0.104633455614075 0.210428394247925 0.318639363964375 0.430727299295457 0.548522282698098 0.674489750196082 0.812217801499913 0.967421566101701 1.15034938037601 1.38299412710064 1.73166439612225];
        case 25, cut_points = [-Inf -1.75068607125217 -1.40507156030963 -1.17498679206609 -0.994457883209753 -0.841621233572914 -0.706302562840088 -0.582841507271216 -0.467698799114508 -0.358458793251194 -0.2533471031358 -0.150969215496777 -0.0501535834647338 0.0501535834647338 0.150969215496777 0.2533471031358 0.358458793251194 0.467698799114508 0.582841507271216 0.706302562840088 0.841621233572914 0.994457883209753 1.17498679206609 1.40507156030963 1.75068607125217];
        case 26, cut_points = [-Inf -1.76882503851871 -1.42607687227285 -1.19837970230692 -1.0200762327862 -0.869423773288886 -0.73631591737613 -0.615141104595973 -0.502402223373355 -0.395725295814487 -0.293381232121193 -0.194028142423926 -0.0965586152896392 0 0.0965586152896392 0.194028142423926 0.293381232121193 0.395725295814487 0.502402223373355 0.615141104595973 0.73631591737613 0.869423773288886 1.0200762327862 1.19837970230692 1.42607687227285 1.76882503851871];
        case 27, cut_points = [-Inf -1.78615556126108 -1.44610359291818 -1.22064034884735 -1.0444087948726 -0.895779818883589 -0.764709673786387 -0.645630749275982 -0.535082815086322 -0.430727299295457 -0.330872571726419 -0.23421919391462 -0.139710298881862 -0.0464357247705272 0.0464357247705272 0.139710298881862 0.23421919391462 0.330872571726419 0.430727299295457 0.535082815086322 0.645630749275982 0.764709673786387 0.895779818883589 1.0444087948726 1.22064034884735 1.44610359291818 1.78615556126108];
        case 28, cut_points = [-Inf -1.80274309073919 -1.46523379268552 -1.24186679184332 -1.06757052387814 -0.920822976368379 -0.791638607743375 -0.674489750196082 -0.565948821932863 -0.463707751457179 -0.36610635680057 -0.271880005399261 -0.180012369792705 -0.0896423510757627 0 0.0896423510757627 0.180012369792705 0.271880005399261 0.36610635680057 0.463707751457179 0.565948821932863 0.674489750196082 0.791638607743375 0.920822976368379 1.06757052387814 1.24186679184332 1.46523379268552 1.80274309073919];
        case 29, cut_points = [-Inf -1.81864559285006 -1.4835398594013 -1.26214517662281 -1.08966198194611 -0.944669591394476 -0.8172368220294 -0.70187259542196 -0.595178533333278 -0.494873163568624 -0.399323067349551 -0.307292571201156 -0.217798379927399 -0.130018583307084 -0.0432311911528171 0.0432311911528171 0.130018583307084 0.217798379927399 0.307292571201156 0.399323067349551 0.494873163568624 0.595178533333278 0.70187259542196 0.8172368220294 0.944669591394476 1.08966198194611 1.26214517662281 1.4835398594013 1.81864559285006];
        case 30, cut_points = [-Inf -1.83391463581591 -1.50108594604403 -1.2815515655446 -1.11077161663679 -0.967421566101701 -0.841621233572914 -0.727913290881644 -0.622925723210088 -0.524400512708041 -0.430727299295457 -0.340694827087795 -0.2533471031358 -0.167894004788106 -0.0836517339071292 0 0.0836517339071292 0.167894004788106 0.2533471031358 0.340694827087795 0.430727299295457 0.524400512708041 0.622925723210088 0.727913290881644 0.841621233572914 0.967421566101701 1.11077161663679 1.2815515655446 1.50108594604403 1.83391463581591];
        case 31, cut_points = [-Inf -1.84859628850141 -1.51792915959428 -1.30015343336342 -1.13097760824516 -0.989168627340635 -0.864894358685283 -0.75272879425817 -0.649323913186466 -0.552442584646774 -0.460494539103116 -0.372289360465191 -0.286893916923039 -0.203544231532486 -0.121587382750483 -0.040440508565646 0.040440508565646 0.121587382750483 0.203544231532486 0.286893916923039 0.372289360465191 0.460494539103116 0.552442584646774 0.649323913186466 0.75272879425817 0.864894358685283 0.989168627340635 1.13097760824516 1.30015343336342 1.51792915959428 1.84859628850141];
        case 32, cut_points = [-Inf -1.86273186742165 -1.53412054435255 -1.31801089730354 -1.15034938037601 -1.00999016924958 -0.887146559018876 -0.776421761147928 -0.674489750196082 -0.579132162255556 -0.488776411114669 -0.402250065321725 -0.318639363964375 -0.237202109328788 -0.157310684610171 -0.0784124127331121 0 0.0784124127331121 0.157310684610171 0.237202109328788 0.318639363964375 0.402250065321725 0.488776411114669 0.579132162255556 0.674489750196082 0.776421761147928 0.887146559018876 1.00999016924958 1.15034938037601 1.31801089730354 1.53412054435255 1.86273186742165];
        case 33, cut_points = [-Inf -1.8763585618946 -1.54970590073659 -1.33517773611894 -1.16894884453148 -1.02995676222537 -0.908457868537385 -0.799082762135179 -0.69852571034506 -0.604585346583237 -0.515704793693038 -0.430727299295457 -0.348755695517045 -0.269066137854314 -0.191052006146174 -0.114185294321428 -0.0379883512302823 0.0379883512302823 0.114185294321428 0.191052006146174 0.269066137854314 0.348755695517045 0.430727299295457 0.515704793693038 0.604585346583237 0.69852571034506 0.799082762135179 0.908457868537385 1.02995676222537 1.16894884453148 1.33517773611894 1.54970590073659 1.8763585618946];
        case 34, cut_points = [-Inf -1.88950996033343 -1.5647264713618 -1.35170223993066 -1.18683143275582 -1.04913139796397 -0.928899491647271 -0.82079208833238 -0.721522283982343 -0.62890421763219 -0.541395085129088 -0.457851931012495 -0.377391943828554 -0.299306910465667 -0.223007830940367 -0.147987109725839 -0.0737912738082727 0 0.0737912738082727 0.147987109725839 0.223007830940367 0.299306910465667 0.377391943828554 0.457851931012495 0.541395085129088 0.62890421763219 0.721522283982343 0.82079208833238 0.928899491647271 1.04913139796397 1.18683143275582 1.35170223993066 1.5647264713618 1.88950996033343];
        case 35, cut_points = [-Inf -1.90221649578202 -1.57921951928357 -1.36762792331569 -1.2040469600267 -1.06757052387814 -0.948535040826638 -0.841621233572914 -0.743559756879431 -0.652178986342786 -0.565948821932863 -0.483738553046103 -0.404677904530047 -0.328072107531651 -0.2533471031358 -0.180012369792705 -0.107634392383102 -0.0358166316600694 0.0358166316600694 0.107634392383102 0.180012369792705 0.2533471031358 0.328072107531651 0.404677904530047 0.483738553046103 0.565948821932863 0.652178986342786 0.743559756879431 0.841621233572914 0.948535040826638 1.06757052387814 1.2040469600267 1.36762792331569 1.57921951928357 1.90221649578202];
        case 36, cut_points = [-Inf -1.91450582505556 -1.59321881802305 -1.38299412710064 -1.22064034884735 -1.08532490807676 -0.967421566101701 -0.861634120174172 -0.764709673786387 -0.674489750196082 -0.589455797849778 -0.508488059109357 -0.430727299295457 -0.355490417839531 -0.282216147062508 -0.210428394247925 -0.139710298881862 -0.0696849203184555 0 0.0696849203184555 0.139710298881862 0.210428394247925 0.282216147062508 0.355490417839531 0.430727299295457 0.508488059109357 0.589455797849778 0.674489750196082 0.764709673786387 0.861634120174172 0.967421566101701 1.08532490807676 1.22064034884735 1.38299412710064 1.59321881802305 1.91450582505556];
        case 37, cut_points = [-Inf -1.92640315296398 -1.60675506896924 -1.3978365289711 -1.23665224151991 -1.10244036701516 -0.98561041686727 -0.88088811958693 -0.785036049876892 -0.695907936878958 -0.611995793699595 -0.532189730919304 -0.455640313737879 -0.381674653765563 -0.30974253153853 -0.239380162671753 -0.170184724112369 -0.101795599094705 -0.0338798354034919 0.0338798354034919 0.101795599094705 0.170184724112369 0.239380162671753 0.30974253153853 0.381674653765563 0.455640313737879 0.532189730919304 0.611995793699595 0.695907936878958 0.785036049876892 0.88088811958693 0.98561041686727 1.10244036701516 1.23665224151991 1.3978365289711 1.60675506896924 1.92640315296398];
        case 38, cut_points = [-Inf -1.93793151085283 -1.61985625863827 -1.41218757890616 -1.25211952026522 -1.11895838106256 -1.00314796766253 -0.899434907667234 -0.8045963803603 -0.716497500177991 -0.633640000779701 -0.554922942702654 -0.47950565333095 -0.406724251871364 -0.336038140371823 -0.266994125404953 -0.199201324789267 -0.132312852276171 -0.0660118123758408 0 0.0660118123758408 0.132312852276171 0.199201324789267 0.266994125404953 0.336038140371823 0.406724251871364 0.47950565333095 0.554922942702654 0.633640000779701 0.716497500177991 0.8045963803603 0.899434907667234 1.00314796766253 1.11895838106256 1.25211952026522 1.41218757890616 1.61985625863827 1.93793151085283];
        case 39, cut_points = [-Inf -1.94911199693989 -1.63254796584635 -1.42607687227285 -1.26707575126644 -1.13491661799349 -1.0200762327862 -0.917321185619228 -0.823442487223818 -0.736315917376129 -0.654452200732004 -0.576758564507798 -0.502402223373355 -0.430727299295457 -0.361201637711319 -0.293381232121193 -0.226885444535879 -0.161379042734239 -0.0965586152896389 -0.0321417933273382 0.0321417933273382 0.0965586152896389 0.161379042734239 0.226885444535879 0.293381232121193 0.361201637711319 0.430727299295457 0.502402223373355 0.576758564507798 0.654452200732004 0.736315917376129 0.823442487223818 0.917321185619228 1.0200762327862 1.13491661799349 1.26707575126644 1.42607687227285 1.63254796584635 1.94911199693989];
        case 40, cut_points = [-Inf -1.95996398454005 -1.64485362695147 -1.43953147093846 -1.2815515655446 -1.15034938037601 -1.03643338949379 -0.93458929107348 -0.841621233572914 -0.755415026360469 -0.674489750196082 -0.597760126042478 -0.524400512708041 -0.45376219016988 -0.385320466407567 -0.318639363964375 -0.2533471031358 -0.189118426272792 -0.125661346855074 -0.0627067779432139 0 0.0627067779432139 0.125661346855074 0.189118426272792 0.2533471031358 0.318639363964375 0.385320466407567 0.45376219016988 0.524400512708041 0.597760126042478 0.674489750196082 0.755415026360469 0.841621233572914 0.93458929107348 1.03643338949379 1.15034938037601 1.2815515655446 1.43953147093846 1.64485362695147 1.95996398454005];
        case 41, cut_points = [-Inf -1.97050530317033 -1.65679476581598 -1.452576180812 -1.29557498709769 -1.16528798969668 -1.05225422555623 -0.951277718729092 -0.85917512959585 -0.773841732337253 -0.693804407736368 -0.617984788468504 -0.545563741822596 -0.475898990436679 -0.408472481974124 -0.342855305390327 -0.27868339741722 -0.215640104012582 -0.153443198823334 -0.0918348329542223 -0.0305733998209062 0.0305733998209062 0.0918348329542223 0.153443198823334 0.215640104012582 0.27868339741722 0.342855305390327 0.408472481974124 0.475898990436679 0.545563741822596 0.617984788468504 0.693804407736368 0.773841732337253 0.85917512959585 0.951277718729092 1.05225422555623 1.16528798969668 1.29557498709769 1.452576180812 1.65679476581598 1.97050530317033];
        case 42, cut_points = [-Inf -1.98075239664728 -1.66839119394708 -1.46523379268552 -1.30917171678578 -1.17976111761186 -1.06757052387814 -0.967421566101701 -0.876142849246841 -0.791638607743375 -0.712443032389489 -0.637484160962377 -0.565948821932863 -0.497200570681554 -0.430727299295457 -0.36610635680057 -0.302980448056206 -0.241040393886027 -0.180012369792705 -0.119648113039842 -0.059717099785323 0 0.059717099785323 0.119648113039842 0.180012369792705 0.241040393886027 0.302980448056206 0.36610635680057 0.430727299295457 0.497200570681554 0.565948821932863 0.637484160962377 0.712443032389489 0.791638607743375 0.876142849246841 0.967421566101701 1.06757052387814 1.17976111761186 1.30917171678578 1.46523379268552 1.66839119394708 1.98075239664728];
        case 43, cut_points = [-Inf -1.99072046158203 -1.67966118531581 -1.47752529201884 -1.32236537889972 -1.1937950727831 -1.0824113944611 -0.98305291689619 -0.89255967293445 -0.808844404113396 -0.730448176998166 -0.656304990866762 -0.585607161223859 -0.517723552817667 -0.452147410767536 -0.388461663983111 -0.326314992004794 -0.265404753824975 -0.205464409067124 -0.14625393380431 -0.0875522464861797 -0.0291509685231212 0.0291509685231212 0.0875522464861797 0.14625393380431 0.205464409067124 0.265404753824975 0.326314992004794 0.388461663983111 0.452147410767536 0.517723552817667 0.585607161223859 0.656304990866762 0.730448176998166 0.808844404113396 0.89255967293445 0.98305291689619 1.0824113944611 1.1937950727831 1.32236537889972 1.47752529201884 1.67966118531581 1.99072046158203];
        case 44, cut_points = [-Inf -2.00042356910598 -1.6906216295849 -1.48947004232794 -1.33517773611894 -1.2074140502222 -1.09680356209351 -0.998201172152886 -0.908457868537385 -0.825494490929236 -0.747858594763302 -0.674489750196082 -0.604585346583237 -0.537519106202773 -0.472789120992267 -0.409983322187337 -0.348755695517045 -0.288809355074463 -0.229884117579232 -0.171747089637512 -0.114185294321428 -0.0569996743583745 0 0.0569996743583745 0.114185294321428 0.171747089637512 0.229884117579232 0.288809355074463 0.348755695517045 0.409983322187337 0.472789120992267 0.537519106202773 0.604585346583237 0.674489750196082 0.747858594763302 0.825494490929236 0.908457868537385 0.998201172152886 1.09680356209351 1.2074140502222 1.33517773611894 1.48947004232794 1.6906216295849 2.00042356910598];
        case 45, cut_points = [-Inf -2.00987477219539 -1.70128816685226 -1.50108594604403 -1.34762887757489 -1.22064034884735 -1.11077161663679 -1.01289333744469 -0.923867020744313 -0.841621233572914 -0.764709673786387 -0.692077136614013 -0.622925723210088 -0.556633621067211 -0.492703333060041 -0.430727299295457 -0.37036424480676 -0.311322379644141 -0.2533471031358 -0.196211733645184 -0.139710298881862 -0.0836517339071292 -0.0278550269854588 0.0278550269854588 0.0836517339071292 0.139710298881862 0.196211733645184 0.2533471031358 0.311322379644141 0.37036424480676 0.430727299295457 0.492703333060041 0.556633621067211 0.622925723210088 0.692077136614013 0.764709673786387 0.841621233572914 0.923867020744313 1.01289333744469 1.11077161663679 1.22064034884735 1.34762887757489 1.50108594604403 1.70128816685226 2.00987477219539];
        case 46, cut_points = [-Inf -2.01908620058314 -1.71167530650973 -1.51238958606768 -1.35973738393861 -1.23349456196869 -1.12433823156864 -1.027154272915 -0.938814316876903 -0.857254320221178 -0.781033811522709 -0.709102503409024 -0.640666889919105 -0.575109281278438 -0.511936213871329 -0.450744212615359 -0.391196258189472 -0.333005098197297 -0.27592106310796 -0.21972291581858 -0.164210777079331 -0.109200481691432 -0.0545189148481012 0 0.0545189148481012 0.109200481691432 0.164210777079331 0.21972291581858 0.27592106310796 0.333005098197297 0.391196258189472 0.450744212615359 0.511936213871329 0.575109281278438 0.640666889919105 0.709102503409024 0.781033811522709 0.857254320221178 0.938814316876903 1.027154272915 1.12433823156864 1.23349456196869 1.35973738393861 1.51238958606768 1.71167530650973 2.01908620058314];
        case 47, cut_points = [-Inf -2.02806914493391 -1.72179653240106 -1.52339635071863 -1.37152047280283 -1.24599574462694 -1.13752435547256 -1.04100691175612 -0.953324795893626 -0.87242104571719 -0.796860738826713 -0.725598230194562 -0.657844124431858 -0.592984553981632 -0.530529760189066 -0.470079986348763 -0.411302053760771 -0.353912771664911 -0.297666850186396 -0.242347851741802 -0.187761229176118 -0.133728811791069 -0.0800842957968131 -0.0266694193761599 0.0266694193761599 0.0800842957968131 0.133728811791069 0.187761229176118 0.242347851741802 0.297666850186396 0.353912771664911 0.411302053760771 0.470079986348763 0.530529760189066 0.592984553981632 0.657844124431858 0.725598230194562 0.796860738826713 0.87242104571719 0.953324795893626 1.04100691175612 1.13752435547256 1.24599574462694 1.37152047280283 1.52339635071863 1.72179653240106 2.02806914493391];
        case 48, cut_points = [-Inf -2.03683413170139 -1.73166439612225 -1.53412054435255 -1.38299412710064 -1.2581615610631 -1.15034938037601 -1.05447245177005 -0.967421566101701 -0.887146559018876 -0.812217801499913 -0.741594043861517 -0.674489750196082 -0.610294610186332 -0.548522282698098 -0.488776411114669 -0.430727299295457 -0.374095410197723 -0.318639363964375 -0.264146976825924 -0.210428394247925 -0.157310684610171 -0.104633455614075 -0.0522451803759405 0 0.0522451803759405 0.104633455614075 0.157310684610171 0.210428394247925 0.264146976825924 0.318639363964375 0.374095410197723 0.430727299295457 0.488776411114669 0.548522282698098 0.610294610186332 0.674489750196082 0.741594043861517 0.812217801499913 0.887146559018876 0.967421566101701 1.05447245177005 1.15034938037601 1.2581615610631 1.38299412710064 1.53412054435255 1.73166439612225 2.03683413170139];
        case 49, cut_points = [-Inf -2.04539098987329 -1.7412906000252 -1.54457548556325 -1.39417320886912 -1.27000841507014 -1.16283129020078 -1.06757052387814 -0.981125996162176 -0.901454079673676 -0.82713020584163 -0.757117297570861 -0.690633454112706 -0.627071687663682 -0.565948821932863 -0.506871622557933 -0.449513565456691 -0.393598415796924 -0.338888301553315 -0.285174828345129 -0.232272293482626 -0.180012369792705 -0.128239825980313 -0.0768089757694082 -0.0255806291232526 0.0255806291232526 0.0768089757694082 0.128239825980313 0.180012369792705 0.232272293482626 0.285174828345129 0.338888301553315 0.393598415796924 0.449513565456691 0.506871622557933 0.565948821932863 0.627071687663682 0.690633454112706 0.757117297570861 0.82713020584163 0.901454079673676 0.981125996162176 1.06757052387814 1.16283129020078 1.27000841507014 1.39417320886912 1.54457548556325 1.7412906000252 2.04539098987329];
        case 50, cut_points = [-Inf -2.05374891063182 -1.75068607125217 -1.55477359459685 -1.40507156030963 -1.2815515655446 -1.17498679206609 -1.08031934081496 -0.994457883209753 -0.915365087842814 -0.841621233572914 -0.772193214188685 -0.706302562840088 -0.643345405392917 -0.582841507271216 -0.524400512708041 -0.467698799114508 -0.412463129441405 -0.358458793251194 -0.305480788099397 -0.2533471031358 -0.201893479141851 -0.150969215496777 -0.10043372051147 -0.0501535834647338 0 0.0501535834647338 0.10043372051147 0.150969215496777 0.201893479141851 0.2533471031358 0.305480788099397 0.358458793251194 0.412463129441405 0.467698799114508 0.524400512708041 0.582841507271216 0.643345405392917 0.706302562840088 0.772193214188685 0.841621233572914 0.915365087842814 0.994457883209753 1.08031934081496 1.17498679206609 1.2815515655446 1.40507156030963 1.55477359459685 1.75068607125217 2.05374891063182];
        case 51, cut_points = [-Inf -2.06191650080946 -1.75986102793353 -1.5647264713618 -1.41570209380051 -1.29280522919942 -1.18683143275582 -1.09273582872572 -1.00743560128731 -0.928899491647271 -0.855712430592972 -0.786845099455005 -0.721522283982343 -0.659143037113206 -0.599229868099345 -0.541395085129088 -0.485317730254962 -0.430727299295457 -0.377391943828554 -0.325109711425282 -0.273701889612983 -0.223007830940367 -0.172880832750767 -0.123184771485879 -0.0737912738082727 -0.0245772610640276 0.0245772610640276 0.0737912738082727 0.123184771485879 0.172880832750767 0.223007830940367 0.273701889612983 0.325109711425282 0.377391943828554 0.430727299295457 0.485317730254962 0.541395085129088 0.599229868099345 0.659143037113206 0.721522283982343 0.786845099455005 0.855712430592972 0.928899491647271 1.00743560128731 1.09273582872572 1.18683143275582 1.29280522919942 1.41570209380051 1.5647264713618 1.75986102793353 2.06191650080946];
        case 52, cut_points = [-Inf -2.06990183089505 -1.76882503851871 -1.57444496521704 -1.42607687227285 -1.30378267210349 -1.19837970230692 -1.10483574396211 -1.0200762327862 -0.942075774995776 -0.869423773288886 -0.80109452928195 -0.73631591737613 -0.674489750196082 -0.615141104595973 -0.557884762839599 -0.502402223373355 -0.448425483305935 -0.395725295814487 -0.344102462883016 -0.293381232121193 -0.243404177810631 -0.194028142423926 -0.145120941210774 -0.0965586152896392 -0.0482230735559219 0 0.0482230735559219 0.0965586152896392 0.145120941210774 0.194028142423926 0.243404177810631 0.293381232121193 0.344102462883016 0.395725295814487 0.448425483305935 0.502402223373355 0.557884762839599 0.615141104595973 0.674489750196082 0.73631591737613 0.80109452928195 0.869423773288886 0.942075774995776 1.0200762327862 1.10483574396211 1.19837970230692 1.30378267210349 1.42607687227285 1.57444496521704 1.76882503851871 2.06990183089505];
        case 53, cut_points = [-Inf -2.07771247824077 -1.77758707507339 -1.58393923755113 -1.43620718115479 -1.31449629146787 -1.20964512638236 -1.11663377702084 -1.03239568516491 -0.954911128553996 -0.882773815517318 -0.814961514850329 -0.750705040808863 -0.689408814978447 -0.630600324263671 -0.573896656348187 -0.518981582211196 -0.465589396943837 -0.413493227930256 -0.362496374813799 -0.312425752996715 -0.263126823295887 -0.214459586272228 -0.166295346135097 -0.118514032206798 -0.0710019212505683 -0.0236496409306192 0.0236496409306192 0.0710019212505683 0.118514032206798 0.166295346135097 0.214459586272228 0.263126823295887 0.312425752996715 0.362496374813799 0.413493227930256 0.465589396943837 0.518981582211196 0.573896656348187 0.630600324263671 0.689408814978447 0.750705040808863 0.814961514850329 0.882773815517318 0.954911128553996 1.03239568516491 1.11663377702084 1.20964512638236 1.31449629146787 1.43620718115479 1.58393923755113 1.77758707507339 2.07771247824077];
        case 54, cut_points = [-Inf -2.08535556603183 -1.78615556126108 -1.59321881802305 -1.44610359291818 -1.32495768889298 -1.22064034884735 -1.12814364527876 -1.0444087948726 -0.967421566101701 -0.895779818883589 -0.828464648581134 -0.764709673786387 -0.703921788828513 -0.645630749275982 -0.589455797849778 -0.535082815086322 -0.482248214837923 -0.430727299295457 -0.380325641763631 -0.330872571726419 -0.282216147062508 -0.23421919391462 -0.186756121063737 -0.139710298881862 -0.0929718485610739 -0.0464357247705272 0 0.0464357247705272 0.0929718485610739 0.139710298881862 0.186756121063737 0.23421919391462 0.282216147062508 0.330872571726419 0.380325641763631 0.430727299295457 0.482248214837923 0.535082815086322 0.589455797849778 0.645630749275982 0.703921788828513 0.764709673786387 0.828464648581134 0.895779818883589 0.967421566101701 1.0444087948726 1.12814364527876 1.22064034884735 1.32495768889298 1.44610359291818 1.59321881802305 1.78615556126108 2.08535556603183];
        case 55, cut_points = [-Inf -2.09283779850577 -1.79453841562937 -1.60229265521588 -1.45577602511702 -1.33517773611894 -1.23137720576342 -1.13937817593599 -1.05612942011718 -0.979622028183723 -0.908457868537385 -0.841621233572914 -0.778348422384844 -0.71804867851301 -0.660253898854463 -0.604585346583237 -0.550730866782214 -0.498428833458718 -0.447456548048964 -0.397621661276507 -0.348755695517045 -0.30070905457492 -0.2533471031358 -0.206547024418835 -0.160195247839394 -0.114185294321428 -0.0684159247003455 -0.022789502280392 0.022789502280392 0.0684159247003455 0.114185294321428 0.160195247839394 0.206547024418835 0.2533471031358 0.30070905457492 0.348755695517045 0.397621661276507 0.447456548048964 0.498428833458718 0.550730866782214 0.604585346583237 0.660253898854463 0.71804867851301 0.778348422384844 0.841621233572914 0.908457868537385 0.979622028183723 1.05612942011718 1.13937817593599 1.23137720576342 1.33517773611894 1.45577602511702 1.60229265521588 1.79453841562937 2.09283779850577];
        case 56, cut_points = [-Inf -2.10016549284447 -1.80274309073919 -1.61116916235268 -1.46523379268552 -1.34516663417664 -1.24186679184332 -1.15034938037601 -1.06757052387814 -0.991526474677331 -0.920822976368379 -0.854447398695989 -0.791638607743375 -0.731808083859617 -0.674489750196082 -0.619306769508776 -0.565948821932863 -0.514156100744534 -0.463707751457179 -0.414413329600077 -0.36610635680057 -0.318639363964375 -0.271880005399261 -0.225707953860159 -0.180012369792705 -0.13468979400892 -0.0896423510757627 -0.0447761766955164 0 0.0447761766955164 0.0896423510757627 0.13468979400892 0.180012369792705 0.225707953860159 0.271880005399261 0.318639363964375 0.36610635680057 0.414413329600077 0.463707751457179 0.514156100744534 0.565948821932863 0.619306769508776 0.674489750196082 0.731808083859617 0.791638607743375 0.854447398695989 0.920822976368379 0.991526474677331 1.06757052387814 1.15034938037601 1.24186679184332 1.34516663417664 1.46523379268552 1.61116916235268 1.80274309073919 2.10016549284447];
        case 57, cut_points = [-Inf -2.1073446081073 -1.81077660860448 -1.61985625863827 -1.47448565515997 -1.35493396671422 -1.25211952026522 -1.16106852098169 -1.07874424836397 -1.00314796766253 -0.93288917320597 -0.866958201203544 -0.8045963803603 -0.745217325237565 -0.688356880905426 -0.633640000779701 -0.58075808400855 -0.529453017544789 -0.47950565333095 -0.430727299295457 -0.382953306125502 -0.336038140371823 -0.289851529166503 -0.244275387814434 -0.199201324789267 -0.154528574694707 -0.110162247968405 -0.0660118123758408 -0.0219897393775453 0.0219897393775453 0.0660118123758408 0.110162247968405 0.154528574694707 0.199201324789267 0.244275387814434 0.289851529166503 0.336038140371823 0.382953306125502 0.430727299295457 0.47950565333095 0.529453017544789 0.58075808400855 0.633640000779701 0.688356880905426 0.745217325237565 0.8045963803603 0.866958201203544 0.93288917320597 1.00314796766253 1.07874424836397 1.16106852098169 1.25211952026522 1.35493396671422 1.47448565515997 1.61985625863827 1.81077660860448 2.1073446081073];
        case 58, cut_points = [-Inf -2.11438077152756 -1.81864559285006 -1.62836140671691 -1.4835398594013 -1.36448874817033 -1.26214517662281 -1.17154617130276 -1.08966198194611 -1.0144987457841 -0.944669591394476 -0.87916771844457 -0.8172368220294 -0.758292556991151 -0.70187259542196 -0.647603582924978 -0.595178533333278 -0.54434091493561 -0.494873163568624 -0.446588204506179 -0.399323067349551 -0.352933986126917 -0.307292571201156 -0.262282765391622 -0.217798379927399 -0.173741061911773 -0.130018583307084 -0.086543367915016 -0.0432311911528171 0 0.0432311911528171 0.086543367915016 0.130018583307084 0.173741061911773 0.217798379927399 0.262282765391622 0.307292571201156 0.352933986126917 0.399323067349551 0.446588204506179 0.494873163568624 0.54434091493561 0.595178533333278 0.647603582924978 0.70187259542196 0.758292556991151 0.8172368220294 0.87916771844457 0.944669591394476 1.0144987457841 1.08966198194611 1.17154617130276 1.26214517662281 1.36448874817033 1.4835398594013 1.62836140671691 1.81864559285006 2.11438077152756];
        case 59, cut_points = [-Inf -2.121279302454 -1.82635629794391 -1.6366916466734 -1.49240417832036 -1.37383946737708 -1.27195296768421 -1.18179227034912 -1.10033441945908 -1.02559029112787 -0.956176538920062 -0.89108913003411 -0.829574036981827 -0.771048868639644 -0.715053037549922 -0.661214792201314 -0.609228667013998 -0.558839610796775 -0.50983153383249 -0.462018858649121 -0.415240160826071 -0.369353293606743 -0.324231584137303 -0.27976081477123 -0.235836786011091 -0.19236331372251 -0.149250551655803 -0.10641355691565 -0.0637710345576306 -0.021244210365719 0.021244210365719 0.0637710345576306 0.10641355691565 0.149250551655803 0.19236331372251 0.235836786011091 0.27976081477123 0.324231584137303 0.369353293606743 0.415240160826071 0.462018858649121 0.50983153383249 0.558839610796775 0.609228667013998 0.661214792201314 0.715053037549922 0.771048868639644 0.829574036981827 0.89108913003411 0.956176538920062 1.02559029112787 1.10033441945908 1.18179227034912 1.27195296768421 1.37383946737708 1.49240417832036 1.6366916466734 1.82635629794391 2.121279302454];
        case 60, cut_points = [-Inf -2.12804523418499 -1.83391463581591 -1.64485362695147 -1.50108594604403 -1.38299412710064 -1.2815515655446 -1.19181617168139 -1.11077161663679 -1.03643338949379 -0.967421566101701 -0.902734791643865 -0.841621233572914 -0.783500375389774 -0.727913290881644 -0.674489750196082 -0.622925723210088 -0.572967548495463 -0.524400512708041 -0.477040428489444 -0.430727299295457 -0.385320466407568 -0.340694827087795 -0.296737838259898 -0.2533471031358 -0.210428394247925 -0.167894004788106 -0.125661346855074 -0.0836517339071292 -0.0417892978164539 0 0.0417892978164539 0.0836517339071292 0.125661346855074 0.167894004788106 0.210428394247925 0.2533471031358 0.296737838259898 0.340694827087795 0.385320466407568 0.430727299295457 0.477040428489444 0.524400512708041 0.572967548495463 0.622925723210088 0.674489750196082 0.727913290881644 0.783500375389774 0.841621233572914 0.902734791643865 0.967421566101701 1.03643338949379 1.11077161663679 1.19181617168139 1.2815515655446 1.38299412710064 1.50108594604403 1.64485362695147 1.83391463581591 2.12804523418499];
        case 61, cut_points = [-Inf -2.13468333391306 -1.84132620013723 -1.65285363251701 -1.50959208990538 -1.3919602799626 -1.29094914768227 -1.20162668788281 -1.1209830393527 -1.04703818482935 -0.978415525720013 -0.914116301414475 -0.853390797663431 -0.79566029928393 -0.740467468641571 -0.687443523449877 -0.636285791799107 -0.586741920076347 -0.53859848315853 -0.491672587911351 -0.445805560400676 -0.400858113491923 -0.356706584870012 -0.313239960732027 -0.270357483332753 -0.227966696566032 -0.185981822220581 -0.144322386314604 -0.102912033721444 -0.0616774825659391 -0.0205475791820155 0.0205475791820155 0.0616774825659391 0.102912033721444 0.144322386314604 0.185981822220581 0.227966696566032 0.270357483332753 0.313239960732027 0.356706584870012 0.400858113491923 0.445805560400676 0.491672587911351 0.53859848315853 0.586741920076347 0.636285791799107 0.687443523449877 0.740467468641571 0.79566029928393 0.853390797663431 0.914116301414475 0.978415525720013 1.04703818482935 1.1209830393527 1.20162668788281 1.29094914768227 1.3919602799626 1.50959208990538 1.65285363251701 1.84132620013723 2.13468333391306];
        case 62, cut_points = [-Inf -2.14119812097202 -1.84859628850141 -1.66069761055404 -1.51792915959428 -1.40074506113058 -1.30015343336342 -1.21123213092134 -1.13097760824516 -1.05741422848638 -0.989168627340635 -0.925244559854151 -0.864894358685283 -0.807541042120077 -0.75272879425817 -0.700090212607567 -0.649323913186466 -0.600178775989845 -0.552442584646774 -0.505933654165812 -0.460494539103116 -0.415987220189675 -0.372289360465191 -0.329291346978122 -0.286893916923039 -0.245006223037321 -0.203544231532486 -0.162429372641286 -0.121587382750483 -0.0809472904812959 -0.040440508565646 0 0.040440508565646 0.0809472904812959 0.121587382750483 0.162429372641286 0.203544231532486 0.245006223037321 0.286893916923039 0.329291346978122 0.372289360465191 0.415987220189675 0.460494539103116 0.505933654165812 0.552442584646774 0.600178775989845 0.649323913186466 0.700090212607567 0.75272879425817 0.807541042120077 0.864894358685283 0.925244559854151 0.989168627340635 1.05741422848638 1.13097760824516 1.21123213092134 1.30015343336342 1.40074506113058 1.51792915959428 1.66069761055404 1.84859628850141 2.14119812097202];
        case 63, cut_points = [-Inf -2.14759388355604 -1.85572992272011 -1.66839119394708 -1.52610335376371 -1.40935521811851 -1.30917171678578 -1.22064034884735 -1.1407637392346 -1.06757052387814 -0.999690486489137 -0.93612982397263 -0.876142849246841 -0.819154251121989 -0.764709673786387 -0.712443032389489 -0.662054166749995 -0.613293123085799 -0.565948821932863 -0.519840708940887 -0.474812482750093 -0.430727299295457 -0.387464044551579 -0.344914392533265 -0.302980448056206 -0.261572829651302 -0.220609086463414 -0.180012369792705 -0.139710298881862 -0.0996339740365978 -0.059717099785323 -0.0198951875980799 0.0198951875980799 0.059717099785323 0.0996339740365978 0.139710298881862 0.180012369792705 0.220609086463414 0.261572829651302 0.302980448056206 0.344914392533265 0.387464044551579 0.430727299295457 0.474812482750093 0.519840708940887 0.565948821932863 0.613293123085799 0.662054166749995 0.712443032389489 0.764709673786387 0.819154251121989 0.876142849246841 0.93612982397263 0.999690486489137 1.06757052387814 1.1407637392346 1.22064034884735 1.30917171678578 1.40935521811851 1.52610335376371 1.66839119394708 1.85572992272011 2.14759388355604];
        case 64, cut_points = [-Inf -2.15387469406146 -1.86273186742165 -1.67593972277344 -1.53412054435255 -1.41779713799627 -1.31801089730354 -1.22985875921659 -1.15034938037601 -1.07751556704028 -1.00999016924958 -0.946781756301046 -0.887146559018876 -0.830510878205399 -0.776421761147928 -0.724514383492365 -0.674489750196082 -0.626099012346421 -0.579132162255556 -0.533409706241281 -0.488776411114669 -0.445096524985516 -0.402250065321725 -0.360129891789569 -0.318639363964375 -0.277690439821577 -0.237202109328788 -0.197099084294312 -0.157310684610171 -0.117769874579095 -0.0784124127331121 -0.0391760855030976 0 0.0391760855030976 0.0784124127331121 0.117769874579095 0.157310684610171 0.197099084294312 0.237202109328788 0.277690439821577 0.318639363964375 0.360129891789569 0.402250065321725 0.445096524985516 0.488776411114669 0.533409706241281 0.579132162255556 0.626099012346421 0.674489750196082 0.724514383492365 0.776421761147928 0.830510878205399 0.887146559018876 0.946781756301046 1.00999016924958 1.07751556704028 1.15034938037601 1.22985875921659 1.31801089730354 1.41779713799627 1.53412054435255 1.67593972277344 1.86273186742165 2.15387469406146];
        otherwise
            disp('Error! alphabet_size is too big');
    end

    for j = 1:length(PAA)
        current_string(j) = sum(cut_points <= PAA(j), 2);  % order is now: a = 1, b = 2, c = 3..
    end

    % Convert the PAA to a string.
    %--------------------------------------------------------------------------------------------------------------------------------------------------------
    %--------------------------------------------------------------------------------------------------------------------------------------------------------
    %--------------------------------------------------------------------------------------------------------------------------------------------------------

    % no numerosity reduction: record everything
    if NR_opt == 1
        symbolic_data    = [symbolic_data; current_string];     % ... add it to the set...
        pointers         = [pointers ; i];                      % ... and add a new pointer.

    % with numerosity reduction: record a string only if it differs from its leftmost neighbor
    elseif NR_opt == 2

        if ~all(current_string == symbolic_data(end,:))             % If the string differs from its leftmost neighbor...
            symbolic_data    = [symbolic_data; current_string];     % ... add it to the set...
            pointers         = [pointers ; i];                      % ... and add a new pointer.
        end;

    % advanced numerosity reduction: record a string only if its mindist to the last recorded
    % string > 0
    elseif NR_opt == 3

        % always record the first string
        if i == 1
            symbolic_data    = [symbolic_data; current_string];     % ... add it to the set...
            pointers         = [pointers ; i];                      % ... and add a new pointer.

        % subsequent strings
        else

            % we only need to check if two sliding windows have different strings (if they are
            % the same then their mindist is 0)
            if ~all(current_string == symbolic_data(end,:))            % If the string differs from its leftmost neighbor...

                % Here we're doing a simplified version of mindist. Since we're only interested
                % in knowing if the distance of two strings is 0, we can do so without any extra
                % computation.  Since only adjacent symbols have distance 0, all we have to
                % do is check if any two symbols are non-adjacent.
                if any(abs(symbolic_data(end,:) - current_string) > 1)
                    symbolic_data    = [symbolic_data; current_string];     % ... add it to the set...
                    pointers         = [pointers ; i];                      % ... and add a new pointer.
                end
            end
        end

    else


        % we only need to check if two sliding windows have different strings (if they are
        % the same then their mindist is 0)
        if ~all(current_string == symbolic_data(end,:))            % If the string differs from its leftmost neighbor...
            if any(abs(symbolic_data(end,:) - current_string) > 1)
                if ~all(sign(diff(current_string)) >= 0) & ~all(sign(diff(current_string)) <= 0)
                    symbolic_data    = [symbolic_data; current_string];     % ... add it to the set...
                    pointers         = [pointers ; i];                      % ... and add a new pointer.
                end
            end
        end
    end

end;

% Delete the first element, it was just used to initialize the data structure
symbolic_data(1,:) = [];